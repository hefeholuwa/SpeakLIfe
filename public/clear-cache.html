<!DOCTYPE html>
<html>
<head>
    <title>Clear Cache - SpeakLife</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        button { background: #8B5CF6; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #7C3AED; }
        .status { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #D1FAE5; color: #065F46; border: 1px solid #A7F3D0; }
        .error { background: #FEE2E2; color: #991B1B; border: 1px solid #FECACA; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧹 Clear Cache - SpeakLife</h1>
        <p>This will clear all caches and force the new favicon to load.</p>
        
        <button onclick="clearAllCaches()">Clear All Caches</button>
        <button onclick="unregisterServiceWorker()">Unregister Service Worker</button>
        <button onclick="reloadPage()">Reload Page</button>
        
        <div id="status"></div>
        
        <h2>Manual Steps:</h2>
        <ol>
            <li>Click "Clear All Caches"</li>
            <li>Click "Unregister Service Worker"</li>
            <li>Click "Reload Page"</li>
            <li>Hard refresh: Ctrl+F5 (Windows) or Cmd+Shift+R (Mac)</li>
        </ol>
    </div>

    <script>
        function showStatus(message, type = 'success') {
            const status = document.getElementById('status');
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        async function clearAllCaches() {
            try {
                // Clear all caches
                const cacheNames = await caches.keys();
                await Promise.all(
                    cacheNames.map(cacheName => caches.delete(cacheName))
                );
                
                // Clear browser cache
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    await Promise.all(
                        registrations.map(registration => registration.unregister())
                    );
                }
                
                showStatus('✅ All caches cleared successfully!');
            } catch (error) {
                showStatus('❌ Error clearing caches: ' + error.message, 'error');
            }
        }

        async function unregisterServiceWorker() {
            try {
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    await Promise.all(
                        registrations.map(registration => registration.unregister())
                    );
                    showStatus('✅ Service worker unregistered!');
                } else {
                    showStatus('ℹ️ No service worker found');
                }
            } catch (error) {
                showStatus('❌ Error unregistering service worker: ' + error.message, 'error');
            }
        }

        function reloadPage() {
            window.location.reload(true);
        }

        // Auto-clear on page load
        window.addEventListener('load', () => {
            clearAllCaches();
        });
    </script>
</body>
</html>
